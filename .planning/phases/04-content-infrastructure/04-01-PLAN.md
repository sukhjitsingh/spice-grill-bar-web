---
phase: 04-content-infrastructure
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - src/layouts/Layout.astro
  - .lighthouserc.json
  - src/components/Footer.astro
  - .planning/ROADMAP.md
autonomous: true
requirements:
  - CONT-01
  - CONT-02
  - CONT-03

must_haves:
  truths:
    - "BreadcrumbSchema generates 'Near Grand Canyon' (not 'Near-grand-canyon') for /near-grand-canyon/"
    - "BreadcrumbSchema generates 'FAQ' (not 'Faq') for /faq/"
    - "BreadcrumbSchema generates 'Directions' for /directions/"
    - ".lighthouserc.json includes /near-grand-canyon/ and /directions/ URLs"
    - "Footer has an Explore section with links to Near Grand Canyon, Directions, and FAQ"
    - "Footer social links (Instagram, Facebook) appear in Explore section with icon + text labels"
    - "Footer bottom bar contains only copyright text — no social links, no FAQ link"
    - "Header navigation is unchanged"
  artifacts:
    - path: "src/layouts/Layout.astro"
      provides: "slugToLabel function with acronym map for breadcrumb labels"
      contains: "slugToLabel"
    - path: ".lighthouserc.json"
      provides: "Lighthouse CI URL list including new pages"
      contains: "near-grand-canyon"
    - path: "src/components/Footer.astro"
      provides: "Explore section with page links and social links"
      contains: "Explore"
  key_links:
    - from: "src/layouts/Layout.astro"
      to: "src/components/schema/BreadcrumbSchema.astro"
      via: "slugToLabel(currentPath) passed as name prop"
      pattern: "slugToLabel\\(currentPath\\)"
    - from: "src/components/Footer.astro"
      to: "/near-grand-canyon/"
      via: "anchor href in Explore section"
      pattern: "href=.*/near-grand-canyon/"
---

<objective>
Fix breadcrumb label generation, add new page URLs to Lighthouse CI, and restructure the footer with an Explore section — so every new content page created in Phase 5 inherits clean scaffolding from day one.

Purpose: Phase 5 creates /near-grand-canyon/ and /directions/ pages. Without this infrastructure, those pages would have broken breadcrumb labels in search results, no Lighthouse CI coverage, and no footer navigation links.

Output: Updated Layout.astro (breadcrumb fix), .lighthouserc.json (new URLs), Footer.astro (Explore section), and ROADMAP.md (remove header nav success criterion per user decision).
</objective>

<execution_context>
@/Users/moni/.claude/get-shit-done/workflows/execute-plan.md
@/Users/moni/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/04-content-infrastructure/04-CONTEXT.md
@.planning/phases/04-content-infrastructure/04-RESEARCH.md
@src/layouts/Layout.astro
@src/components/Footer.astro
@.lighthouserc.json
</context>

<tasks>

<task type="auto">
  <name>Task 1: Fix breadcrumb label generation and add LHCI URLs</name>
  <files>src/layouts/Layout.astro, .lighthouserc.json</files>
  <action>
**Layout.astro — breadcrumb label fix (CONT-01):**

In the frontmatter section (between the `---` fences), add a `slugToLabel` function with an acronym map. Place it after the `canonicalURL` const (line 28):

```ts
const BREADCRUMB_ACRONYMS: Record<string, string> = { faq: 'FAQ' };

function slugToLabel(path: string): string {
  const segment = path.split('/').filter(Boolean).pop() ?? '';
  if (!segment) return '';
  return segment
    .split('-')
    .map(word => BREADCRUMB_ACRONYMS[word.toLowerCase()] ?? (word.charAt(0).toUpperCase() + word.slice(1)))
    .join(' ');
}
```

Then replace the BreadcrumbSchema call (lines 109-123) with:

```astro
<BreadcrumbSchema
  items={[
    { name: 'Home', item: '/' },
    ...(currentPath !== '/'
      ? [{ name: slugToLabel(currentPath), item: currentPath }]
      : []),
  ]}
/>
```

This produces: `/near-grand-canyon/` -> "Near Grand Canyon", `/faq/` -> "FAQ", `/directions/` -> "Directions".

**IMPORTANT:** Do NOT modify anything else in Layout.astro. The Header component is explicitly locked per CONTEXT.md.

**.lighthouserc.json — add new page URLs (CONT-02):**

Change the `url` array from `["/"]` to `["/", "/near-grand-canyon/", "/directions/"]`.

**Note about CI sequencing:** These pages do not exist yet (created in Phase 5). Lighthouse CI will 404 on these URLs until Phase 5 completes. This is expected and acceptable per CONT-02 — the config is the deliverable, not the pages. The pre-push `qa` hook will fail on these URLs until Phase 5 pages are built. If this blocks development, the executor may temporarily comment out the new URLs with a `// TODO: uncomment after Phase 5` note — but the URLs MUST be present (uncommented) by the end of Phase 5.
  </action>
  <verify>
Run `npm run build` to confirm Layout.astro compiles without errors. Then manually inspect the built HTML for `/faq/` to confirm the breadcrumb schema contains `"name": "FAQ"` (not `"name": "Faq"`):

```bash
npm run build && grep -o '"name":"[^"]*"' dist/faq/index.html | head -5
```

For .lighthouserc.json, confirm the URL array:
```bash
node -e "const c = require('./.lighthouserc.json'); console.log(c.ci.collect.url)"
```
Expected: `[ '/', '/near-grand-canyon/', '/directions/' ]`
  </verify>
  <done>
BreadcrumbSchema produces "Near Grand Canyon" for /near-grand-canyon/, "FAQ" for /faq/, and "Directions" for /directions/. The .lighthouserc.json url array contains all three page URLs.
  </done>
</task>

<task type="auto">
  <name>Task 2: Restructure footer with Explore section and update ROADMAP</name>
  <files>src/components/Footer.astro, .planning/ROADMAP.md</files>
  <action>
**Footer.astro — add Explore section and restructure (CONT-03):**

Per locked decisions in CONTEXT.md:

1. **Change the footer grid** from `md:grid-cols-4` to allow 4 equal columns. Remove the `col-span-1 md:col-span-2` from the brand section, making it `col-span-1` only. The grid becomes: Brand | Visit Us | Hours | Explore. Use `grid-cols-1 sm:grid-cols-2 md:grid-cols-4` for responsive behavior.

2. **Add a new "Explore" section** as the 4th column in the grid. It contains:
   - **Page links:** Near Grand Canyon (`/near-grand-canyon/`), Directions (`/directions/`), FAQ (`/faq/`)
   - **Social links (moved from bottom bar):** Instagram and Facebook with icon + text labels

   Structure for page links — use `<ul>` with same text styling as the Hours section:
   ```astro
   <div>
     <p class="text-zinc-900 dark:text-white text-xs font-semibold tracking-wider uppercase mb-4">
       Explore
     </p>
     <ul class="text-zinc-600 dark:text-zinc-300 text-sm space-y-3">
       <li>
         <a href="/near-grand-canyon/" class="hover:text-zinc-900 dark:hover:text-white transition-colors block focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-orange-500 rounded-sm">
           Near Grand Canyon
         </a>
       </li>
       <li>
         <a href="/directions/" class="hover:text-zinc-900 dark:hover:text-white transition-colors block focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-orange-500 rounded-sm">
           Directions
         </a>
       </li>
       <li>
         <a href="/faq/" class="hover:text-zinc-900 dark:hover:text-white transition-colors block focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-orange-500 rounded-sm">
           FAQ
         </a>
       </li>
     </ul>
   </div>
   ```

   For social links, add them after the page links list with a visual separator (`pt-2` or `mt-3 pt-3 border-t`). Keep the existing SVG paths for Instagram and Facebook icons. Add `<span>` text labels alongside each icon:
   ```astro
   <li class="pt-2">
     <a href="https://www.instagram.com/panjabi_dhaba_sgb?utm_source=ig_web_button_share_sheet&igsh=ZDNlZDc0MzIxNw=="
        target="_blank" rel="noopener noreferrer"
        class="flex items-center gap-2 hover:text-zinc-900 dark:hover:text-white transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-orange-500 rounded-sm w-fit"
        aria-label="Follow us on Instagram">
       <!-- existing Instagram SVG (keep exact same path d="M7.0301...") -->
       <svg role="img" viewBox="0 0 24 24" class="w-4 h-4 fill-current shrink-0" xmlns="http://www.w3.org/2000/svg">
         <path d="M7.0301.084c-1.2768..."></path>
       </svg>
       <span>Instagram</span>
     </a>
   </li>
   ```
   Same pattern for Facebook with its existing SVG path.

3. **Clean up the bottom bar:** Remove the social links `<div>` (Instagram, Facebook `<a>` tags) and the FAQ `<a>` tag from the bottom bar. The bottom bar should contain ONLY the copyright paragraph. Change the bottom bar flex layout from `flex-col md:flex-row justify-between` to `flex justify-center` since there is only one element:

   ```astro
   <div class="max-w-7xl mx-auto px-6 mt-16 pt-8 pb-20 md:pb-8 border-t border-zinc-100 dark:border-zinc-900 flex justify-center items-center text-xs text-zinc-600 dark:text-zinc-400">
     <p>&copy; 2024 Spice Grill &amp; Bar. All rights reserved.</p>
   </div>
   ```

**CRITICAL — avoid duplication pitfall:** When moving social links to Explore, REMOVE them from the bottom bar. The rendered HTML must have exactly one Instagram link and one Facebook link, both in the Explore section.

**ROADMAP.md — update Phase 4 success criteria:**

Per CONTEXT.md locked decision, remove success criterion #3 ("Header navigation includes links to /near-grand-canyon/ and /directions/") from Phase 4. Renumber the remaining criteria. The updated success criteria should be:

1. BreadcrumbSchema generates human-readable labels for hyphenated slugs
2. .lighthouserc.json includes /near-grand-canyon/ and /directions/
3. Footer links include /near-grand-canyon/ and /directions/ (via Explore section)

Also update the Phase 4 plans section from "TBD" to "1 plan" and update the plan list.
  </action>
  <verify>
Run `npm run build` to confirm Footer.astro compiles. Then check the rendered footer HTML:

```bash
npm run build && grep -c "instagram" dist/index.html
```
Expected: exactly 1 occurrence of "instagram" (in Explore section, not duplicated in bottom bar).

```bash
grep "Explore" dist/index.html
```
Expected: the word "Explore" appears in the footer section.

```bash
grep "near-grand-canyon" dist/index.html
```
Expected: at least 1 occurrence (footer link).

Verify bottom bar has no social links:
```bash
grep -A5 "All rights reserved" dist/index.html
```
Expected: no `<a>` tags for Instagram/Facebook near the copyright line.
  </verify>
  <done>
Footer has 4-column grid with Brand, Visit Us, Hours, and Explore sections. Explore section contains links to Near Grand Canyon, Directions, FAQ, plus Instagram and Facebook with icon+text labels. Bottom bar is copyright-only. ROADMAP.md Phase 4 success criteria updated to remove header nav requirement.
  </done>
</task>

</tasks>

<verification>
1. `npm run build` succeeds without errors
2. Breadcrumb schema in built HTML shows "FAQ" for /faq/ page (not "Faq")
3. Footer renders exactly one Instagram link and one Facebook link (both in Explore section)
4. Footer has Near Grand Canyon, Directions, and FAQ page links in Explore section
5. Footer bottom bar contains only copyright text
6. Header.tsx is unchanged (verify with `git diff src/components/Header.tsx` showing no changes)
7. .lighthouserc.json url array has 3 entries: "/", "/near-grand-canyon/", "/directions/"
8. ROADMAP.md Phase 4 success criteria no longer mentions header navigation
</verification>

<success_criteria>
- Build passes: `npm run build` exits 0
- BreadcrumbSchema label for /near-grand-canyon/ is "Near Grand Canyon" in built HTML
- BreadcrumbSchema label for /faq/ is "FAQ" in built HTML
- Footer Explore section exists with 3 page links + 2 social links (icon+text)
- Footer bottom bar is copyright-only
- .lighthouserc.json includes all 3 page URLs
- No changes to Header.tsx
</success_criteria>

<output>
After completion, create `.planning/phases/04-content-infrastructure/04-01-SUMMARY.md`
</output>
