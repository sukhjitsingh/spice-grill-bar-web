---
phase: 06-data-consistency-lighthouse
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - src/data/faq.json
  - src/components/Footer.astro
  - src/components/Header.tsx
  - src/components/MobileActionButtons.astro
  - .lighthouserc.json
autonomous: true
requirements:
  - FAQ-01
  - CONT-02
  - CONT-05

must_haves:
  truths:
    - "faq.json Flagstaff entry states 51 miles and 46 minutes, matching all other codebase surfaces"
    - "Every tel: URI in the codebase uses E.164 format (tel:+19282771292) with no bare tel:9282771292 links"
    - ".lighthouserc.json audits all 4 live pages (/, /near-grand-canyon/, /directions/, /faq/)"
    - "npm run qa passes with zero regressions"
  artifacts:
    - path: "src/data/faq.json"
      provides: "Corrected Flagstaff distance and drive time"
      contains: "51 miles west of Flagstaff"
    - path: ".lighthouserc.json"
      provides: "Full 4-URL Lighthouse CI coverage"
      contains: "/faq/"
  key_links:
    - from: "src/data/faq.json"
      to: "src/pages/near-grand-canyon.astro"
      via: "consistent Flagstaff distance data"
      pattern: "51 miles"
    - from: "src/components/Footer.astro"
      to: "src/components/schema/RestaurantSchema.astro"
      via: "consistent E.164 phone format"
      pattern: "tel:\\+19282771292"
---

<objective>
Fix three narrowly scoped data inconsistencies identified in the v1.0 milestone audit: correct Flagstaff distance drift in faq.json, standardize all tel: URIs to E.164 format, and add /faq/ to Lighthouse CI coverage.

Purpose: Eliminate cross-phase data drift so the milestone ships with zero known inconsistencies across all codebase surfaces.
Output: Five files edited with consistent data; npm run qa passes.
</objective>

<execution_context>
@/Users/moni/.claude/get-shit-done/workflows/execute-plan.md
@/Users/moni/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/06-data-consistency-lighthouse/06-RESEARCH.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Fix faq.json Flagstaff distance and standardize tel: URIs across 3 components</name>
  <files>
    src/data/faq.json
    src/components/Footer.astro
    src/components/Header.tsx
    src/components/MobileActionButtons.astro
  </files>
  <action>
    **faq.json Flagstaff entry fix (entry index 5, 0-based):**
    Find the entry with question "Where to eat between Flagstaff and the Grand Canyon?" and replace the answer string:
    - Change "about 50 miles" to "about 51 miles"
    - Change "roughly a 40-minute drive" to "roughly a 46-minute drive"
    - Do NOT change the question text or any other entries
    - The corrected answer should read: "Spice Grill & Bar is about 51 miles west of Flagstaff on I-40, roughly a 46-minute drive. Take Exit 146 in Ash Fork for Indian food before or after your Grand Canyon visit."

    **tel: URI standardization (3 files):**
    In each of the following files, change `href="tel:9282771292"` to `href="tel:+19282771292"`:
    1. `src/components/Footer.astro` — phone link href attribute
    2. `src/components/Header.tsx` — phone link href attribute
    3. `src/components/MobileActionButtons.astro` — phone link href attribute

    Do NOT change the visible display text (e.g., "(928) 277-1292") — only the href attribute value.
    Do NOT touch Header.tsx navigation array — only the tel: href (user decision: Header nav is locked).
    Do NOT modify RestaurantSchema.astro — its telephone property is already correct in a different format (+1-928-277-1292).
  </action>
  <verify>
    Run: `grep -r 'tel:9282771292' src/` — must return zero matches (all bare tel: URIs eliminated).
    Run: `grep -r 'tel:+19282771292' src/` — must return matches in Footer.astro, Header.tsx, MobileActionButtons.astro, and directions.astro (7 occurrences).
    Run: `grep '51 miles' src/data/faq.json` — must return a match.
    Run: `grep '50 miles' src/data/faq.json` — must return zero matches.
  </verify>
  <done>faq.json Flagstaff entry says "51 miles" and "46-minute drive"; all tel: URIs use E.164 format tel:+19282771292; no bare tel:9282771292 links remain in src/.</done>
</task>

<task type="auto">
  <name>Task 2: Add /faq/ to Lighthouse CI and run full QA</name>
  <files>
    .lighthouserc.json
  </files>
  <action>
    **Add /faq/ to Lighthouse CI URL array:**
    In `.lighthouserc.json`, find the `url` array (currently `["/", "/near-grand-canyon/", "/directions/"]`) and append `"/faq/"` to produce:
    ```json
    "url": ["/", "/near-grand-canyon/", "/directions/", "/faq/"]
    ```

    **Run full QA:**
    Execute `npm run qa` which runs build + test:quality + test:lhci. This validates:
    - All 4 pages build successfully
    - Lighthouse CI passes for all 4 URLs (LCP < 4000ms, Accessibility >= 90, SEO >= 90)
    - Linting, typecheck, and AEO audit pass
    - No regressions from the data edits in Task 1

    If Lighthouse CI fails specifically for /faq/ with a pre-existing issue (not caused by this phase's changes), document it and continue — it indicates a separate concern.
  </action>
  <verify>
    Run: `npm run qa` — must exit 0 with all checks passing.
    Confirm .lighthouserc.json url array has exactly 4 entries: "/", "/near-grand-canyon/", "/directions/", "/faq/".
  </verify>
  <done>.lighthouserc.json audits 4 pages; npm run qa passes with zero failures; no regressions from Phase 6 edits.</done>
</task>

</tasks>

<verification>
1. `grep -r 'tel:9282771292' src/` returns zero matches
2. `grep -r 'tel:+19282771292' src/` returns matches in Footer.astro, Header.tsx, MobileActionButtons.astro, plus existing directions.astro occurrences
3. faq.json Flagstaff entry contains "51 miles" and "46-minute"
4. .lighthouserc.json url array contains exactly ["/", "/near-grand-canyon/", "/directions/", "/faq/"]
5. `npm run qa` exits 0
</verification>

<success_criteria>
- Zero data inconsistencies: Flagstaff distance is "51 miles / 46 minutes" across all surfaces (faq.json, near-grand-canyon.astro, directions.astro, llms.txt, llms-full.txt)
- Zero bare tel: URIs: every phone link uses tel:+19282771292
- Full Lighthouse CI coverage: all 4 live pages audited on every push
- npm run qa passes clean
</success_criteria>

<output>
After completion, create `.planning/phases/06-data-consistency-lighthouse/06-01-SUMMARY.md`
</output>
